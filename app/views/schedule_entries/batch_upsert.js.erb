<% @entries.each do |entry| %>
var $cell = $('.schedule-cell[data-user-id="<%= entry.user_id %>"][data-date="<%= entry.date %>"]');

<% if entry.display_text.present? %>
  $cell.html('<%= j entry.display_text %>');
  $cell.css('background-color', '<%= entry.background_color %>');
  $cell.removeClass('empty-cell');
<% else %>
  $cell.html('');
  $cell.css('background-color', '#ffffff');
  $cell.addClass('empty-cell');
<% end %>

$cell.data('entry-id', <%= entry.id %>);
<% end %>

// Update weekly hours
<% @weekly_hours.each do |user_id, hours| %>
$('.weekly-hours-cell[data-user-id="<%= user_id %>"]').text('<%= hours %>');
<% end %>

// Update department summary counts
<% @department_counts.each do |(dept_id, shift_id, date), count| %>
$('.summary-count-cell[data-department-id="<%= dept_id %>"][data-shift-id="<%= shift_id %>"][data-date="<%= date %>"]').text(<%= count > 0 ? count : "''".html_safe %>);
<% end %>
